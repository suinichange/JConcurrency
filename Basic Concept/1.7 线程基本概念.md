## 为什么要引入线程？

　　操作系统为了使多个程序并发执行引入了进程，以提高资源利用率和系统吞吐量。但是进程作为一个可拥有资源的独立单位，在创建、撤销、上下文切换时会付出较大的时间，空间上的开销。这就限制了系统所能设置进程的数量，而且进程切换也不宜太频繁，从而限制了并发程度。（进程“太重”了）

　　而引入线程，就是为了减少程序在并发执行时所付出的时空开销，使操作系统具有更好的并发性。

## 线程与进程的区别

　　线程具有许多传统进程所具有的特征，所以又称之为轻型进程（ Light－ WeighProcess）或进程元。下面我们从调度性、并发性、系统开销和拥有资源等方面对线程和进程进行比较。

### 调度的基本单位

　　在传统的OS中，进程是作为独立调度和分派的基本单位，因而进程是能独立运行的基本单位。在每次被调度时，都需要进行上下文切换，开销较大。而在引入线程的OS中，已把线程作为调度和分派的基本单位，因而线程是能独立运行的基本单位。当线程切换时，仅需保存和设置少量寄存器内容，切换代价远低于进程。

　　在同一进程中，线程的切换不会引起进程的切換，但从一个进程中的线程切换到另一个进程中的线程时，必然就会引起进程的切换。
　　
### 并发性

　　在引入线程的OS中，不仅进程之间可以并发执行，而且在一个进程中的多个线程之间亦可并发执行。同样，不同进程中的线程也能并发执行。这使得OS具有更好的并发性，从而能更加有效地提高系统资源的利用率和系统的吞吐量。

### 拥有资源

　　进程可以拥有资源，并作为系统中有资源的一个基本单位。然面，线程本身并不拥有系统资源，而是仅有一点必不可少的、能保证独立运行的资源。比如，在每个线程中都应具有一个用于控制线程运行的线程控制块TCB、用于指示被执行指令序列的程序计数器保留局部变量、少数状态参数和返回地址等的一组寄存器和堆栈。线程除了拥有自己的少量资源外，还允许多个线程共享该进程所拥有的资源。

### 独立性

　　在同一进程中的不同线程之间的独立性要比不同进程之间的独立性低得多。这是因为，为防止进程之间彼此干扰和破坏，每个进程都拥有一个独立的地址空间和其它资源，除了共享全局变量外，不允许其它进程的访问。

　　但是同一进程中的不同线程往往是为了提高并发性以及进行相互之间的合作而创建的，它们共享进程的内存地址空间和资源，如每个线程都可以访问它们所属进程地址空间中的所有地址，如一个线程的堆栈可以被其它线程读、写，甚至完全清除。

### 系统开销

　　在创建或撤消进程时，系统都要为之分配和回收进程控制块、分配或回收其它资源，如内存空间和1O设各等。OS为此所付出的开销，明显大于线程创建或撤消时所付出的开销。同样在进程切换时，涉及到进程上下文的切换，而线程的切换代价也远低于进程。此外，由于一个进程中的多个线程具有相同的地址空间，线程之间的同步和通信也比进程的简单。

### 支持多处理机系统

　　在多处理机系统中，对于传统的进程，即单线程进程，不管有多少处理机，该进程只能运行在一个处理机上。但对于多线程进程，就可以将一个进程中的多个线程分配到多个处理机上，使它们并行执行，这无疑将加速进程的完成。因此，现代多处理机OS都无不例外地引入了多线程。